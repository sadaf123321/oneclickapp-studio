<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background: radial-gradient(circle at top left, #1e293b, #0f172a);
            overflow: hidden;
        }
        .glass-panel {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 2rem;
        }
        .calc-btn {
            transition: all 0.1s ease;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        .calc-btn:active {
            transform: scale(0.92);
            background: rgba(255, 255, 255, 0.2) !important;
        }
        .display-area {
            height: 160px;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            align-items: flex-end;
            padding: 1.5rem;
        }
    </style>
</head>
<body class="h-[100dvh] flex items-center justify-center p-4">

    <div class="glass-panel w-full max-w-md h-full max-h-[750px] flex flex-col overflow-hidden shadow-2xl">
        <!-- Display Section -->
        <div class="display-area text-right">
            <div id="history-display" class="text-slate-400 text-sm mb-1 overflow-hidden h-6"></div>
            <div id="main-display" class="text-white text-6xl font-light tracking-tighter truncate w-full">0</div>
        </div>

        <!-- Buttons Grid -->
        <div class="flex-1 grid grid-cols-4 gap-3 p-6 bg-white/5 rounded-t-[3rem]">
            <!-- Row 1 -->
            <button onclick="window.clearDisplay()" class="calc-btn flex items-center justify-center rounded-2xl bg-white/10 text-orange-400 font-semibold text-xl">AC</button>
            <button onclick="window.appendOperator('/')" class="calc-btn flex items-center justify-center rounded-2xl bg-white/10 text-cyan-400 text-2xl">รท</button>
            <button onclick="window.appendOperator('*')" class="calc-btn flex items-center justify-center rounded-2xl bg-white/10 text-cyan-400 text-2xl">ร</button>
            <button onclick="window.deleteLast()" class="calc-btn flex items-center justify-center rounded-2xl bg-white/10 text-red-400">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 4H8l-7 8 7 8h13a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2z"/><line x1="18" y1="9" x2="12" y2="15"/><line x1="12" y1="9" x2="18" y2="15"/></svg>
            </button>

            <!-- Row 2 -->
            <button onclick="window.appendNumber('7')" class="calc-btn flex items-center justify-center rounded-2xl bg-white/5 text-white text-2xl">7</button>
            <button onclick="window.appendNumber('8')" class="calc-btn flex items-center justify-center rounded-2xl bg-white/5 text-white text-2xl">8</button>
            <button onclick="window.appendNumber('9')" class="calc-btn flex items-center justify-center rounded-2xl bg-white/5 text-white text-2xl">9</button>
            <button onclick="window.appendOperator('-')" class="calc-btn flex items-center justify-center rounded-2xl bg-white/10 text-cyan-400 text-3xl">-</button>

            <!-- Row 3 -->
            <button onclick="window.appendNumber('4')" class="calc-btn flex items-center justify-center rounded-2xl bg-white/5 text-white text-2xl">4</button>
            <button onclick="window.appendNumber('5')" class="calc-btn flex items-center justify-center rounded-2xl bg-white/5 text-white text-2xl">5</button>
            <button onclick="window.appendNumber('6')" class="calc-btn flex items-center justify-center rounded-2xl bg-white/5 text-white text-2xl">6</button>
            <button onclick="window.appendOperator('+')" class="calc-btn flex items-center justify-center rounded-2xl bg-white/10 text-cyan-400 text-3xl">+</button>

            <!-- Row 4 -->
            <button onclick="window.appendNumber('1')" class="calc-btn flex items-center justify-center rounded-2xl bg-white/5 text-white text-2xl">1</button>
            <button onclick="window.appendNumber('2')" class="calc-btn flex items-center justify-center rounded-2xl bg-white/5 text-white text-2xl">2</button>
            <button onclick="window.appendNumber('3')" class="calc-btn flex items-center justify-center rounded-2xl bg-white/5 text-white text-2xl">3</button>
            <button onclick="window.calculate()" class="calc-btn row-span-2 flex items-center justify-center rounded-2xl bg-cyan-500 text-white text-3xl shadow-lg shadow-cyan-500/20">=</button>

            <!-- Row 5 -->
            <button onclick="window.appendNumber('0')" class="calc-btn col-span-2 flex items-center justify-center rounded-2xl bg-white/5 text-white text-2xl">0</button>
            <button onclick="window.appendNumber('.')" class="calc-btn flex items-center justify-center rounded-2xl bg-white/5 text-white text-2xl">.</button>
        </div>
    </div>

    <script>
        let currentInput = '0';
        let previousInput = '';
        let operator = null;
        let shouldResetScreen = false;

        const mainDisplay = document.getElementById('main-display');
        const historyDisplay = document.getElementById('history-display');

        function triggerHaptic() {
            if (window.NativeBridge && window.NativeBridge.vibrate) {
                window.NativeBridge.vibrate(10);
            }
        }

        window.appendNumber = (number) => {
            triggerHaptic();
            if (currentInput === '0' || shouldResetScreen) {
                currentInput = number;
                shouldResetScreen = false;
            } else {
                currentInput += number;
            }
            updateDisplay();
        };

        window.appendOperator = (op) => {
            triggerHaptic();
            if (operator !== null) window.calculate();
            previousInput = currentInput;
            operator = op;
            historyDisplay.innerText = `${previousInput} ${op}`;
            shouldResetScreen = true;
        };

        window.clearDisplay = () => {
            triggerHaptic();
            currentInput = '0';
            previousInput = '';
            operator = null;
            historyDisplay.innerText = '';
            updateDisplay();
        };

        window.deleteLast = () => {
            triggerHaptic();
            if (currentInput.length > 1) {
                currentInput = currentInput.slice(0, -1);
            } else {
                currentInput = '0';
            }
            updateDisplay();
        };

        window.calculate = () => {
            triggerHaptic();
            if (operator === null || shouldResetScreen) return;
            let result;
            const prev = parseFloat(previousInput);
            const current = parseFloat(currentInput);

            switch (operator) {
                case '+': result = prev + current; break;
                case '-': result = prev - current; break;
                case '*': result = prev * current; break;
                case '/': result = prev / current; break;
                default: return;
            }

            historyDisplay.innerText = `${previousInput} ${operator} ${currentInput} =`;
            currentInput = result.toString().length > 10 ? result.toPrecision(8).toString() : result.toString();
            operator = null;
            shouldResetScreen = true;
            updateDisplay();
        };

        function updateDisplay() {
            mainDisplay.innerText = currentInput;
        }
    </script>
</body>
</html>